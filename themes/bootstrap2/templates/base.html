<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>{% block title %}{{ SITENAME }}{% endblock %}</title>

<!-- 	  script-src 'wasm-unsafe-eval' 'wasm-eval'; object-src 'none'; -->
    <meta http-equiv="content-security-policy" content=""/>

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="{{ AUTHOR }}">
    <meta name="authors" content="{{ AUTHORS }}">
    <meta name="year" content="{{ YEAR }}">
    <meta name="bibfile" content="{{ BIBFILE }}">
    <meta name="pdffile" content="{{ PDFFILE }}">

    <link rel="stylesheet" href="{{ SITEURL }}/theme/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="{{ SITEURL }}/theme/css/custom.css" type="text/css" />
    <link rel="stylesheet" href="{{ SITEURL }}/theme/css/stork-basic.css" />

    <link href="{{ SITEURL }}/theme/css/bootstrap-responsive.min.css" rel="stylesheet">
    <link href="{{ SITEURL }}/theme/css/font-awesome.css" rel="stylesheet">
    <link href="{{ SITEURL }}/theme/css/pygments.css" rel="stylesheet">

  </head>

  <body id="drop-area">
    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="{{ SITEURL }}/index.html">{{ SITENAME }} {% if SITESUBTITLE %} <strong>{{ SITESUBTITLE }}</strong>{% endif %}</a>
          <div class="nav-collapse">
            <ul class="nav">
              {% for title, link in MENUITEMS %}
                <li><a href="{{ link }}">{{ title }}</a></li>
              {% endfor %}
              {% if DISPLAY_PAGES_ON_MENU %}
                {% for page in pages %}
                  <li><a href="{{ SITEURL }}/{{ page.url }}">{{ page.title }}</a></li>
                {% endfor %}
              <li class="divider-vertical"></li>
              {% endif %}
              {% if DISPLAY_CATEGORIES_ON_MENU %}
                {% for cat, null in categories %}
                  <li {% if cat == category %}class="active"{% endif %}>
                    <a href="{{ SITEURL }}/{{ cat.url }}">
                      <i class="icon-folder-open icon-large"></i>{{ cat }}
                    </a>
                  </li>
                {% endfor %}
              {% endif %}
            </ul>
          </div>
        </div>
      </div>
    </div>
    <div class="container-fluid">
      <div class="row">
        <div class="span9" id="content">
          <div class="stork-wrapper">
            <p>
              <input id="stork-input" class="stork-input" data-stork="sitesearch" placeholder="Search publication"/>
              <button type="button" id="add-button" onclick="confirmBib()">Add reference</button>
            </p>
            <p>
              <div class="stork-output" data-stork="sitesearch-output"></div>
            </p>
          </div>
          {% block content %}
          {% endblock %}
          <p>
            <div class="small">
              Last Updated: {{ BUILD_TIME | strftime("%b %d, %Y, %H:%M:%S") }}
            </div>
            <div id="status" class = "small">
            </div>
          </p>      
        </div>
      </div>
  </div>

    <script src="{{ SITEURL }}/theme/js/jquery-1.7.2.min.js"></script>
    <script src="{{ SITEURL }}/theme/js/bootstrap.min.js"></script>
    <script src="{{ SITEURL }}/theme/js/bibtexParse.js"></script>
    <script src="{{ SITEURL }}/theme/js/pdf.js"></script>
    <script> pdfjsLib.GlobalWorkerOptions.workerSrc = '{{ SITEURL }}/theme/js/pdf.worker.js';</script>

    <script type="module">
      import { Octokit } from "https://esm.sh/@octokit/rest";
      var pat = "g i t h u b _ p a t _ 1 1 A B C B U P Q 0 l w 1 1 T Z q z c J j B _ p K S o S y i I R 9 X d Q A m 1 l L 4 Q n Z E 0 b 6 J y 0 b Q g q E F 8 V W 9 R o T n 5 B V Z N 3 H X Z c B h f o g F"
      pat = pat.replaceAll(" ", "");
      const octokit = new Octokit({ auth: pat });
      window.octokit = octokit;
      console.log("Octokit loaded");
    </script>

    <script src="{{ SITEURL }}/theme/js/librarian.js"></script>
	  
    <script defer src="{{ SITEURL }}/theme/js/stork-1.6/stork.js" onload="storkInit()">
	    async function storkInit() {
		  stork.initialize("{{ SITEURL }}/theme/js/stork-1.6/stork.wasm");
		  options = {showScores: false};
		
		  const deferred = async function() { //Async Function Expression
		    stork.register("sitesearch", "{{ SITEURL }}/search-index.st", options);
		    console.log("stork initialised");
		  };
		
		  deferred();
		  
	}
    </script>
    
  </body>
</html>
